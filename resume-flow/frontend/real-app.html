<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResumeFlow - AIæ™ºèƒ½æ±‚èŒå¹³å°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            padding: 40px 0;
        }
        
        .header h1 {
            font-size: 3.5rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #fff, #f0f8ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: 1.3rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
        }
        
        .card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }
        
        .card h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
        }
        
        .upload-area:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-color: #5a67d8;
            transform: scale(1.02);
        }
        
        .upload-area.dragover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            border-color: #4c51bf;
            transform: scale(1.05);
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            font-weight: 600;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #718096 0%, #4a5568 100%);
            box-shadow: 0 4px 15px rgba(113, 128, 150, 0.3);
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #2d3748;
            font-size: 0.95rem;
        }
        
        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f7fafc;
        }
        
        .input-group input:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .results {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .results h4 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.3rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .version-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .version-card:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        
        .stat-item {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #718096;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        .success {
            color: #38a169;
            font-weight: 600;
        }
        
        .error {
            color: #e53e3e;
            font-weight: 600;
        }
        
        .warning {
            color: #d69e2e;
            font-weight: 600;
        }
        
        .info {
            color: #3182ce;
            font-weight: 600;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .file-info {
            background: linear-gradient(135deg, #e6fffa, #b2f5ea);
            border: 1px solid #38b2ac;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            color: #234e52;
        }
        
        .keyword-tag {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            margin: 3px;
            font-weight: 500;
        }
        
        .missing-keyword {
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
            color: #742a2a;
        }
        
        .platform-result {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #38a169;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .platform-result.failed {
            border-left-color: #e53e3e;
        }
        
        .interview-score {
            font-size: 3rem;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .star-radar {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .star-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .star-score {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        
        .star-label {
            color: #718096;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .card {
                padding: 20px;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ ResumeFlow Pro</h1>
            <p>ä¸“ä¸šçº§AIæ™ºèƒ½æ±‚èŒå¹³å° - çœŸå®æ–‡ä»¶è§£æ Â· æ™ºèƒ½ä¼˜åŒ– Â· ç²¾å‡†æŠ•é€’</p>
        </div>
        
        <div class="dashboard">
            <!-- ç®€å†ä¸Šä¼ ä¸è§£æ -->
            <div class="card">
                <h3>ğŸ“„ æ™ºèƒ½ç®€å†è§£æ</h3>
                <div class="upload-area" id="uploadArea">
                    <div id="uploadContent">
                        <p style="font-size: 1.5rem; margin-bottom: 15px;">ğŸ“</p>
                        <p style="font-weight: 600; margin-bottom: 10px;">æ‹–æ‹½ç®€å†æ–‡ä»¶åˆ°æ­¤å¤„</p>
                        <p style="font-size: 0.9rem; color: #718096;">æ”¯æŒ PDFã€Word (doc/docx) æ ¼å¼ï¼Œæœ€å¤§ 5MB</p>
                    </div>
                    <input type="file" id="fileInput" accept=".pdf,.doc,.docx" style="display: none;">
                </div>
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" onclick="document.getElementById('fileInput').click()">é€‰æ‹©æ–‡ä»¶</button>
                    <button class="btn btn-secondary" onclick="clearFile()">æ¸…é™¤</button>
                </div>
                <div id="fileInfo" class="file-info hidden"></div>
                <div id="uploadResult" class="results hidden"></div>
            </div>
            
            <!-- AIç®€å†ä¼˜åŒ– -->
            <div class="card">
                <h3>ğŸ¤– AIæ™ºèƒ½ä¼˜åŒ–</h3>
                <div class="input-group">
                    <label for="jobDescription">ç›®æ ‡èŒä½JDï¼ˆè¯¦ç»†æè¿°ï¼‰ï¼š</label>
                    <textarea id="jobDescription" rows="6" placeholder="è¯·ç²˜è´´å®Œæ•´çš„èŒä½æè¿°ï¼ŒåŒ…æ‹¬ï¼š
- å²—ä½èŒè´£
- ä»»èŒè¦æ±‚  
- æŠ€èƒ½è¦æ±‚
- å·¥ä½œç»éªŒè¦æ±‚
- æ•™è‚²èƒŒæ™¯è¦æ±‚

è¶Šè¯¦ç»†ï¼Œä¼˜åŒ–æ•ˆæœè¶Šå¥½ï¼"></textarea>
                </div>
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" id="optimizeBtn" onclick="optimizeResume()">å¼€å§‹æ™ºèƒ½ä¼˜åŒ–</button>
                    <button class="btn btn-secondary" onclick="clearOptimization()">é‡ç½®</button>
                </div>
                <div id="optimizeResult" class="results hidden"></div>
            </div>
            
            <!-- æ™ºèƒ½æŠ•é€’ -->
            <div class="card">
                <h3>ğŸ¯ ç²¾å‡†æŠ•é€’</h3>
                <div class="input-group">
                    <label for="keywords">èŒä½å…³é”®è¯ï¼ˆå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰ï¼š</label>
                    <input type="text" id="keywords" placeholder="å¦‚ï¼šå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ, React, Vue.js, å…¨æ ˆå¼€å‘">
                </div>
                <div class="input-group">
                    <label for="location">æœŸæœ›å·¥ä½œåœ°ç‚¹ï¼š</label>
                    <input type="text" id="location" placeholder="å¦‚ï¼šåŒ—äº¬, ä¸Šæµ·, æ·±åœ³, æ­å·">
                </div>
                <div class="input-group">
                    <label for="salaryRange">æœŸæœ›è–ªèµ„èŒƒå›´ï¼š</label>
                    <input type="text" id="salaryRange" placeholder="å¦‚ï¼š15-25K, 20-35K">
                </div>
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" id="deliverBtn" onclick="autoDeliver()">å¼€å§‹æ™ºèƒ½æŠ•é€’</button>
                    <button class="btn btn-secondary" onclick="clearDelivery()">é‡ç½®</button>
                </div>
                <div id="deliverResult" class="results hidden"></div>
            </div>
            
            <!-- AIé¢è¯•æ•™ç»ƒ -->
            <div class="card">
                <h3>ğŸ¤ AIé¢è¯•æ•™ç»ƒ</h3>
                <div class="input-group">
                    <label for="interviewQuestion">é¢è¯•é—®é¢˜ï¼š</label>
                    <input type="text" id="interviewQuestion" placeholder="è¯·è¾“å…¥é¢è¯•é—®é¢˜ï¼Œå¦‚ï¼šè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±">
                </div>
                <div class="input-group">
                    <label for="interviewAnswer">ä½ çš„å›ç­”ï¼ˆå°½é‡è¯¦ç»†ï¼‰ï¼š</label>
                    <textarea id="interviewAnswer" rows="5" placeholder="è¯·è¾“å…¥ä½ çš„å›ç­”ï¼Œå»ºè®®åŒ…å«ï¼š
- å…·ä½“æƒ…å¢ƒ (Situation)
- ä»»åŠ¡ç›®æ ‡ (Task) 
- é‡‡å–è¡ŒåŠ¨ (Action)
- æœ€ç»ˆç»“æœ (Result)

éµå¾ªSTARæ³•åˆ™ï¼Œå›ç­”ä¼šæ›´å‡ºè‰²ï¼"></textarea>
                </div>
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" id="evaluateBtn" onclick="evaluateInterview()">è·å–ä¸“ä¸šè¯„ä¼°</button>
                    <button class="btn btn-secondary" onclick="clearInterview()">é‡ç½®</button>
                </div>
                <div id="interviewResult" class="results hidden"></div>
            </div>
        </div>
        
        <!-- ç³»ç»ŸçŠ¶æ€é¢æ¿ -->
        <div class="card">
            <h3>ğŸ“Š ç³»ç»ŸçŠ¶æ€ç›‘æ§</h3>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="apiStatus">ğŸŸ¡</div>
                    <div class="stat-label">APIçŠ¶æ€</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="parseQuality">0</div>
                    <div class="stat-label">è§£æè´¨é‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="optimizeCount">0</div>
                    <div class="stat-label">ä¼˜åŒ–æ¬¡æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="deliverCount">0</div>
                    <div class="stat-label">æŠ•é€’æ¬¡æ•°</div>
                </div>
            </div>
            <div id="systemLog" style="margin-top: 20px; font-size: 0.9rem; color: #718096;"></div>
        </div>
    </div>

    <script>
        // APIé…ç½®
        const API_BASE_URL = 'http://localhost:3001';
        
        // å…¨å±€çŠ¶æ€
        let currentFile = null;
        let currentParsedData = null;
        let systemStats = {
            parseQuality: 0,
            optimizations: 0,
            deliveries: 0,
            apiStatus: 'checking'
        };
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeSystem();
            setupFileUpload();
            checkAPIStatus();
            setInterval(checkAPIStatus, 30000);
        });
        
        // ç³»ç»Ÿåˆå§‹åŒ–
        function initializeSystem() {
            logSystem('ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
            logSystem('å¼€å§‹æ£€æµ‹APIæœåŠ¡çŠ¶æ€...');
        }
        
        // è®¾ç½®æ–‡ä»¶ä¸Šä¼ 
        function setupFileUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload(files[0]);
                }
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFileUpload(e.target.files[0]);
                }
            });
        }
        
        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        async function handleFileUpload(file) {
            if (!file) return;
            
            // éªŒè¯æ–‡ä»¶ç±»å‹
            const allowedTypes = ['application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/msword'];
            const fileName = file.name.toLowerCase();
            const isValidType = allowedTypes.includes(file.type) || 
                               fileName.endsWith('.pdf') || 
                               fileName.endsWith('.doc') || 
                               fileName.endsWith('.docx');
            
            if (!isValidType) {
                alert('âŒ è¯·ä¸Šä¼ PDFæˆ–Wordæ ¼å¼çš„æ–‡ä»¶');
                return;
            }
            
            // éªŒè¯æ–‡ä»¶å¤§å°
            if (file.size > 5 * 1024 * 1024) {
                alert('âŒ æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB');
                return;
            }
            
            currentFile = file;
            displayFileInfo(file);
            
            const uploadContent = document.getElementById('uploadContent');
            const resultDiv = document.getElementById('uploadResult');
            
            uploadContent.innerHTML = '<div class="loading"></div><p>æ­£åœ¨è§£ææ–‡ä»¶...</p>';
            
            try {
                const formData = new FormData();
                formData.append('resume', file);
                formData.append('userId', 'demo_user_' + Date.now());
                
                const response = await fetch(`${API_BASE_URL}/api/resume/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentParsedData = result.data.parsedData;
                    systemStats.parseQuality = result.data.parseQuality?.score || 0;
                    
                    logSystem(`âœ… æ–‡ä»¶è§£ææˆåŠŸ: ${file.name}`);
                    logSystem(`ğŸ“Š è§£æè´¨é‡: ${systemStats.parseQuality}%`);
                    
                    uploadContent.innerHTML = `
                        <p style="color: #38a169; font-weight: bold; font-size: 1.1rem;">âœ… æ–‡ä»¶è§£ææˆåŠŸ</p>
                        <p><strong>æ–‡ä»¶åï¼š</strong>${file.name}</p>
                        <p><strong>æ–‡ä»¶å¤§å°ï¼š</strong>${(file.size / 1024).toFixed(1)} KB</p>
                    `;
                    
                    displayParseResults(result.data);
                    updateStats();
                } else {
                    throw new Error(result.error || 'è§£æå¤±è´¥');
                }
            } catch (error) {
                logSystem(`âŒ æ–‡ä»¶è§£æå¤±è´¥: ${error.message}`);
                uploadContent.innerHTML = `
                    <p style="color: #e53e3e; font-weight: bold;">âŒ è§£æå¤±è´¥</p>
                    <p>${error.message}</p>
                    <p style="font-size: 0.9rem; color: #718096;">è¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œå†…å®¹</p>
                `;
            }
            
            resultDiv.classList.remove('hidden');
        }
        
        // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
        function displayFileInfo(file) {
            const fileInfo = document.getElementById('fileInfo');
            fileInfo.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">ğŸ“„</span>
                    <div>
                        <strong>${file.name}</strong>
                        <div style="font-size: 0.9rem; color: #718096;">
                            å¤§å°: ${(file.size / 1024).toFixed(1)} KB | 
                            ç±»å‹: ${file.type || 'æœªçŸ¥'}
                        </div>
                    </div>
                </div>
            `;
            fileInfo.classList.remove('hidden');
        }
        
        // æ˜¾ç¤ºè§£æç»“æœ
        function displayParseResults(data) {
            const resultDiv = document.getElementById('uploadResult');
            const { parsedData, parseQuality } = data;
            
            resultDiv.innerHTML = `
                <h4>ğŸ“‹ è§£æç»“æœè¯¦æƒ…ï¼š</h4>
                <div style="margin-bottom: 15px;">
                    <strong>è§£æè´¨é‡ï¼š</strong>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${parseQuality.score}%"></div>
                    </div>
                    <small>${parseQuality.score}% å®Œæ•´åº¦</small>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div class="version-card" style="border-left-color: #38a169;">
                        <h6 style="color: #38a169; margin-bottom: 10px;">ğŸ‘¤ åŸºæœ¬ä¿¡æ¯</h6>
                        <p><strong>å§“åï¼š</strong>${parsedData.name || 'æœªè¯†åˆ«'}</p>
                        <p><strong>é‚®ç®±ï¼š</strong>${parsedData.email || 'æœªè¯†åˆ«'}</p>
                        <p><strong>ç”µè¯ï¼š</strong>${parsedData.phone || 'æœªè¯†åˆ«'}</p>
                    </div>
                    
                    <div class="version-card" style="border-left-color: #3182ce;">
                        <h6 style="color: #3182ce; margin-bottom: 10px;">ğŸ“ æ•™è‚²èƒŒæ™¯</h6>
                        ${parsedData.education && parsedData.education.length > 0 ? 
                            parsedData.education.map(edu => `
                                <div style="margin-bottom: 8px;">
                                    <strong>${edu.institution}</strong><br>
                                    <small>${edu.degree} ${edu.major}</small>
                                </div>
                            `).join('') : 
                            '<p style="color: #718096;">æœªè¯†åˆ«åˆ°æ•™è‚²ä¿¡æ¯</p>'
                        }
                    </div>
                    
                    <div class="version-card" style="border-left-color: #d69e2e;">
                        <h6 style="color: #d69e2e; margin-bottom: 10px;">ğŸ’¼ å·¥ä½œç»å†</h6>
                        ${parsedData.workExperience && parsedData.workExperience.length > 0 ? 
                            parsedData.workExperience.map(work => `
                                <div style="margin-bottom: 8px;">
                                    <strong>${work.company}</strong><br>
                                    <small>${work.position} | ${work.duration}</small>
                                </div>
                            `).join('') : 
                            '<p style="color: #718096;">æœªè¯†åˆ«åˆ°å·¥ä½œç»å†</p>'
                        }
                    </div>
                    
                    <div class="version-card" style="border-left-color: #805ad5;">
                        <h6 style="color: #805ad5; margin-bottom: 10px;">ğŸ› ï¸ æŠ€èƒ½æ ‡ç­¾</h6>
                        ${parsedData.skills && parsedData.skills.length > 0 ? 
                            parsedData.skills.map(skill => 
                                `<span class="keyword-tag">${skill}</span>`
                            ).join('') : 
                            '<p style="color: #718096;">æœªè¯†åˆ«åˆ°æŠ€èƒ½ä¿¡æ¯</p>'
                        }
                    </div>
                </div>
            `;
        }
        
        // ç®€å†ä¼˜åŒ–åŠŸèƒ½
        async function optimizeResume() {
            if (!currentParsedData) {
                alert('âŒ è¯·å…ˆä¸Šä¼ å¹¶è§£æç®€å†æ–‡ä»¶');
                return;
            }
            
            const jobDescription = document.getElementById('jobDescription').value.trim();
            if (!jobDescription) {
                alert('âŒ è¯·è¾“å…¥ç›®æ ‡èŒä½JD');
                return;
            }
            
            const optimizeBtn = document.getElementById('optimizeBtn');
            const resultDiv = document.getElementById('optimizeResult');
            
            optimizeBtn.disabled = true;
            optimizeBtn.innerHTML = 'AIä¼˜åŒ–ä¸­<span class="loading"></span>';
            
            try {
                logSystem('ğŸ¤– å¼€å§‹AIç®€å†ä¼˜åŒ–...');
                
                // æ„å»ºç®€å†æ–‡æœ¬
                const resumeText = `
å§“åï¼š${currentParsedData.name}
é‚®ç®±ï¼š${currentParsedData.email}  
ç”µè¯ï¼š${currentParsedData.phone}
æ•™è‚²èƒŒæ™¯ï¼š${currentParsedData.education?.map(e => `${e.institution} ${e.degree} ${e.major}`).join(', ') || ''}
å·¥ä½œç»å†ï¼š${currentParsedData.workExperience?.map(w => `${w.company} ${w.position} ${w.duration}`).join(', ') || ''}
æŠ€èƒ½ï¼š${currentParsedData.skills?.join(', ') || ''}
                `.trim();
                
                const response = await fetch(`${API_BASE_URL}/api/optimize/resume`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        resumeText,
                        jobDescription,
                        userId: 'demo_user',
                        resumeId: 'demo_resume'
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    systemStats.optimizations++;
                    logSystem(`âœ… AIä¼˜åŒ–å®Œæˆï¼ŒåŒ¹é…ç‡: ${result.data.keywordMatchRate}%`);
                    
                    displayOptimizationResults(result.data);
                    
                    optimizeBtn.innerHTML = 'âœ… ä¼˜åŒ–å®Œæˆ';
                    setTimeout(() => {
                        optimizeBtn.disabled = false;
                        optimizeBtn.innerHTML = 'å¼€å§‹æ™ºèƒ½ä¼˜åŒ–';
                    }, 2000);
                } else {
                    throw new Error(result.error || 'ä¼˜åŒ–å¤±è´¥');
                }
            } catch (error) {
                logSystem(`âŒ AIä¼˜åŒ–å¤±è´¥: ${error.message}`);
                resultDiv.innerHTML = `<p class="error">âŒ ä¼˜åŒ–å¤±è´¥ï¼š${error.message}</p>`;
                
                optimizeBtn.disabled = false;
                optimizeBtn.innerHTML = 'å¼€å§‹æ™ºèƒ½ä¼˜åŒ–';
            }
            
            resultDiv.classList.remove('hidden');
            updateStats();
        }
        
        // æ˜¾ç¤ºä¼˜åŒ–ç»“æœ
        function displayOptimizationResults(data) {
            const resultDiv = document.getElementById('optimizeResult');
            
            resultDiv.innerHTML = `
                <h4>ğŸ¯ ä¼˜åŒ–ç»“æœåˆ†æï¼š</h4>
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span><strong>å…³é”®è¯åŒ¹é…ç‡ï¼š</strong></span>
                        <span class="success">${data.keywordMatchRate}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${data.keywordMatchRate}%"></div>
                    </div>
                </div>
                
                ${data.missingKeywords && data.missingKeywords.length > 0 ? `
                    <div style="margin-bottom: 20px;">
                        <h6 style="color: #d69e2e; margin-bottom: 10px;">âš ï¸ ç¼ºå¤±å…³é”®è¯å»ºè®®è¡¥å……ï¼š</h6>
                        ${data.missingKeywords.map(keyword => 
                            `<span class="keyword-tag missing-keyword">${keyword}</span>`
                        ).join('')}
                    </div>
                ` : ''}
                
                <h6 style="margin-bottom: 15px;">ğŸ“‹ ä¼˜åŒ–ç‰ˆæœ¬å¯¹æ¯”ï¼š</h6>
                ${data.versions.map((version, index) => `
                    <div class="version-card" style="border-left-color: ${['#38a169', '#3182ce', '#805ad5'][index]};">
                        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 10px;">
                            <h6 style="color: ${['#38a169', '#3182ce', '#805ad5'][index]}; margin: 0;">${version.name}</h6>
                            <span class="success" style="font-weight: bold;">åŒ¹é…åº¦: ${version.keywordMatchRate}%</span>
                        </div>
                        <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <div style="white-space: pre-wrap; font-size: 0.9rem; line-height: 1.5;">${version.content}</div>
                        </div>
                        <div style="margin-top: 15px;">
                            <button class="btn" style="padding: 8px 16px; font-size: 0.9rem;" onclick="copyVersion(${index})">å¤åˆ¶æ­¤ç‰ˆæœ¬</button>
                            <button class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.9rem;" onclick="downloadVersion(${index})">ä¸‹è½½</button>
                        </div>
                    </div>
                `).join('')}
            `;
        }
        
        // æ™ºèƒ½æŠ•é€’åŠŸèƒ½
        async function autoDeliver() {
            if (!currentParsedData) {
                alert('âŒ è¯·å…ˆä¸Šä¼ å¹¶è§£æç®€å†');
                return;
            }
            
            const keywords = document.getElementById('keywords').value.trim();
            const location = document.getElementById('location').value.trim();
            const salaryRange = document.getElementById('salaryRange').value.trim();
            
            if (!keywords) {
                alert('âŒ è¯·è¾“å…¥èŒä½å…³é”®è¯');
                return;
            }
            
            const deliverBtn = document.getElementById('deliverBtn');
            const resultDiv = document.getElementById('deliverResult');
            
            deliverBtn.disabled = true;
            deliverBtn.innerHTML = 'æŠ•é€’ä¸­<span class="loading"></span>';
            
            try {
                logSystem('ğŸ¯ å¼€å§‹æ™ºèƒ½æŠ•é€’...');
                
                const response = await fetch(`${API_BASE_URL}/api/deliver/auto`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        userId: 'demo_user',
                        resumeId: 'demo_resume',
                        jobFilters: {
                            keywords: keywords,
                            location: location,
                            salaryRange: salaryRange,
                            maxApplications: 10,
                            minMatchScore: 60
                        },
                        userCredentials: {
                            boss: { username: '', password: '' },
                            zhilian: { username: '', password: '' },
                            '51job': { username: '', password: '' }
                        }
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    systemStats.deliveries++;
                    logSystem(`âœ… æŠ•é€’å®Œæˆï¼ŒæˆåŠŸç‡: ${result.data.stats.successRate}%`);
                    
                    displayDeliveryResults(result.data);
                    
                    deliverBtn.innerHTML = 'âœ… æŠ•é€’å®Œæˆ';
                    setTimeout(() => {
                        deliverBtn.disabled = false;
                        deliverBtn.innerHTML = 'å¼€å§‹æ™ºèƒ½æŠ•é€’';
                    }, 2000);
                } else {
                    throw new Error(result.error || 'æŠ•é€’å¤±è´¥');
                }
            } catch (error) {
                logSystem(`âŒ æŠ•é€’å¤±è´¥: ${error.message}`);
                resultDiv.innerHTML = `<p class="error">âŒ æŠ•é€’å¤±è´¥ï¼š${error.message}</p>`;
                
                deliverBtn.disabled = false;
                deliverBtn.innerHTML = 'å¼€å§‹æ™ºèƒ½æŠ•é€’';
            }
            
            resultDiv.classList.remove('hidden');
            updateStats();
        }
        
        // æ˜¾ç¤ºæŠ•é€’ç»“æœ
        function displayDeliveryResults(data) {
            const resultDiv = document.getElementById('deliverResult');
            const { results, stats } = data;
            
            const platformNames = {
                'boss': 'BOSSç›´è˜',
                'zhilian': 'æ™ºè”æ‹›è˜',
                '51job': 'å‰ç¨‹æ— å¿§'
            };
            
            resultDiv.innerHTML = `
                <h4>ğŸ¯ æŠ•é€’ç»“æœæŠ¥å‘Šï¼š</h4>
                <div style="background: linear-gradient(135deg, #e6fffa, #b2f5ea); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; text-align: center;">
                        <div>
                            <div style="font-size: 2rem; font-weight: bold; color: #38a169;">${stats.successRate}%</div>
                            <div style="color: #234e52; font-size: 0.9rem;">æ€»ä½“æˆåŠŸç‡</div>
                        </div>
                        <div>
                            <div style="font-size: 2rem; font-weight: bold; color: #3182ce;">${stats.total}</div>
                            <div style="color: #234e52; font-size: 0.9rem;">æŠ•é€’å¹³å°æ•°</div>
                        </div>
                        <div>
                            <div style="font-size: 2rem; font-weight: bold; color: #805ad5;">${stats.success}</div>
                            <div style="color: #234e52; font-size: 0.9rem;">æˆåŠŸå¹³å°æ•°</div>
                        </div>
                    </div>
                </div>
                
                <h6 style="margin-bottom: 15px;">ğŸ“‹ å„å¹³å°è¯¦ç»†ç»“æœï¼š</h6>
                ${Object.entries(results).map(([platform, data]) => `
                    <div class="platform-result ${data.success ? '' : 'failed'}">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h6 style="margin: 0; color: ${data.success ? '#38a169' : '#e53e3e'};">
                                ${platformNames[platform]}
                                ${data.success ? 'âœ…' : 'âŒ'}
                            </h6>
                            <span style="font-weight: bold; color: ${data.success ? '#38a169' : '#e53e3e'};">
                                ${data.success ? 'æŠ•é€’æˆåŠŸ' : 'æŠ•é€’å¤±è´¥'}
                            </span>
                        </div>
                        <p style="margin-bottom: 10px;">${data.message}</p>
                        ${data.details?.appliedJobs && data.details.appliedJobs.length > 0 ? `
                            <div style="margin-top: 15px;">
                                <strong>æˆåŠŸæŠ•é€’èŒä½ï¼š</strong>
                                ${data.details.appliedJobs.map(job => `
                                    <div style="background: white; padding: 10px; border-radius: 8px; margin: 8px 0; border-left: 3px solid #38a169;">
                                        <div style="font-weight: 600;">${job.jobTitle}</div>
                                        <div style="color: #718096; font-size: 0.9rem;">${job.company}</div>
                                        ${job.matchScore ? `<div style="color: #38a169; font-size: 0.8rem;">åŒ¹é…åº¦: ${job.matchScore}%</div>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `).join('')}
                
                <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #fef5e7, #fed7d7); border-radius: 10px;">
                    <h6 style="color: #d69e2e; margin-bottom: 10px;">ğŸ’¡ æŠ•é€’å»ºè®®ï¼š</h6>
                    <ul style="margin: 0; padding-left: 20px; color: #744210;">
                        <li>å»ºè®®å®šæœŸæ£€æŸ¥æŠ•é€’çŠ¶æ€ï¼ŒåŠæ—¶è·Ÿè¿›</li>
                        <li>å¯æ ¹æ®åé¦ˆè°ƒæ•´ç®€å†å†…å®¹å’Œå…³é”®è¯</li>
                        <li>ä¿æŒç®€å†å†…å®¹çš„çœŸå®æ€§å’Œå‡†ç¡®æ€§</li>
                    </ul>
                </div>
            `;
        }
        
        // é¢è¯•è¯„ä¼°åŠŸèƒ½
        async function evaluateInterview() {
            const question = document.getElementById('interviewQuestion').value.trim();
            const answer = document.getElementById('interviewAnswer').value.trim();
            
            if (!question || !answer) {
                alert('âŒ è¯·è¾“å…¥é¢è¯•é—®é¢˜å’Œå›ç­”');
                return;
            }
            
            if (answer.length < 50) {
                alert('âŒ å›ç­”å†…å®¹è¿‡äºç®€å•ï¼Œå»ºè®®è¯¦ç»†æè¿°ï¼Œéµå¾ªSTARæ³•åˆ™');
                return;
            }
            
            const evaluateBtn = document.getElementById('evaluateBtn');
            const resultDiv = document.getElementById('interviewResult');
            
            evaluateBtn.disabled = true;
            evaluateBtn.innerHTML = 'AIè¯„ä¼°ä¸­<span class="loading"></span>';
            
            try {
                logSystem('ğŸ¤ å¼€å§‹AIé¢è¯•è¯„ä¼°...');
                
                const response = await fetch(`${API_BASE_URL}/api/interview/evaluate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        question: question,
                        answer: answer
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    logSystem(`âœ… é¢è¯•è¯„ä¼°å®Œæˆï¼Œæ€»åˆ†: ${result.data.score}åˆ†`);
                    
                    displayInterviewResults(result.data);
                    
                    evaluateBtn.innerHTML = 'âœ… è¯„ä¼°å®Œæˆ';
                    setTimeout(() => {
                        evaluateBtn.disabled = false;
                        evaluateBtn.innerHTML = 'è·å–ä¸“ä¸šè¯„ä¼°';
                    }, 2000);
                } else {
                    throw new Error(result.error || 'è¯„ä¼°å¤±è´¥');
                }
            } catch (error) {
                logSystem(`âŒ é¢è¯•è¯„ä¼°å¤±è´¥: ${error.message}`);
                resultDiv.innerHTML = `<p class="error">âŒ è¯„ä¼°å¤±è´¥ï¼š${error.message}</p>`;
                
                evaluateBtn.disabled = false;
                evaluateBtn.innerHTML = 'è·å–ä¸“ä¸šè¯„ä¼°';
            }
            
            resultDiv.classList.remove('hidden');
        }
        
        // æ˜¾ç¤ºé¢è¯•è¯„ä¼°ç»“æœ
        function displayInterviewResults(data) {
            const resultDiv = document.getElementById('interviewResult');
            const { score, feedback, starAnalysis } = data;
            
            let grade = 'ä¼˜ç§€';
            let gradeColor = '#38a169';
            if (score < 80) {
                grade = 'è‰¯å¥½';
                gradeColor = '#3182ce';
            }
            if (score < 70) {
                grade = 'ä¸€èˆ¬';
                gradeColor = '#d69e2e';
            }
            if (score < 60) {
                grade = 'éœ€è¦æ”¹è¿›';
                gradeColor = '#e53e3e';
            }
            
            resultDiv.innerHTML = `
                <h4>ğŸ¤ é¢è¯•è¯„ä¼°æŠ¥å‘Šï¼š</h4>
                
                <div style="text-align: center; margin: 30px 0;">
                    <div class="interview-score">${score}</div>
                    <div style="font-size: 1.2rem; color: ${gradeColor}; font-weight: 600;">${grade}</div>
                    <div style="color: #718096; font-size: 0.9rem;">æ€»åˆ† 100 åˆ†</div>
                </div>
                
                <div class="star-radar">
                    <div class="star-item">
                        <div class="star-score">${starAnalysis.situation}</div>
                        <div class="star-label">æƒ…å¢ƒ (Situation)</div>
                        <div style="font-size: 0.8rem; color: #718096;">èƒŒæ™¯æè¿°</div>
                    </div>
                    <div class="star-item">
                        <div class="star-score">${starAnalysis.task}</div>
                        <div class="star-label">ä»»åŠ¡ (Task)</div>
                        <div style="font-size: 0.8rem; color: #718096;">ç›®æ ‡è®¾å®š</div>
                    </div>
                    <div class="star-item">
                        <div class="star-score">${starAnalysis.action}</div>
                        <div class="star-label">è¡ŒåŠ¨ (Action)</div>
                        <div style="font-size: 0.8rem; color: #718096;">å…·ä½“è¡ŒåŠ¨</div>
                    </div>
                    <div class="star-item">
                        <div class="star-score">${starAnalysis.result}</div>
                        <div class="star-label">ç»“æœ (Result)</div>
                        <div style="font-size: 0.8rem; color: #718096;">æœ€ç»ˆæˆæœ</div>
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, #fef5e7, #fed7d7); border-radius: 15px; padding: 20px; margin: 20px 0;">
                    <h6 style="color: #d69e2e; margin-bottom: 15px;">ğŸ’¡ ä¸“ä¸šåé¦ˆå»ºè®®ï¼š</h6>
                    <p style="margin: 0; line-height: 1.6;">${feedback}</p>
                </div>
                
                <div style="background: linear-gradient(135deg, #e6fffa, #b2f5ea); border-radius: 15px; padding: 20px;">
                    <h6 style="color: #38a169; margin-bottom: 15px;">ğŸ¯ æ”¹è¿›å»ºè®®ï¼š</h6>
                    <ul style="margin: 0; padding-left: 20px; color: #234e52;">
                        ${score < 80 ? '<li>å»ºè®®å¢åŠ æ›´å¤šå…·ä½“ç»†èŠ‚å’Œé‡åŒ–æ•°æ®</li>' : ''}
                        ${starAnalysis.situation < 8 ? '<li>èƒŒæ™¯æƒ…å¢ƒæè¿°å¯ä»¥æ›´å…·ä½“æ¸…æ™°</li>' : ''}
                        ${starAnalysis.task < 8 ? '<li>ä»»åŠ¡ç›®æ ‡éœ€è¦æ›´æ˜ç¡®é‡åŒ–</li>' : ''}
                        ${starAnalysis.action < 8 ? '<li>å…·ä½“è¡ŒåŠ¨æ­¥éª¤å¯ä»¥æ›´è¯¦ç»†</li>' : ''}
                        ${starAnalysis.result < 8 ? '<li>æœ€ç»ˆæˆæœå»ºè®®ç”¨æ•°æ®é‡åŒ–</li>' : ''}
                        <li>å¤šç»ƒä¹ ç±»ä¼¼é—®é¢˜ï¼Œæå‡è¡¨è¾¾èƒ½åŠ›</li>
                        <li>å‡†å¤‡æ›´å¤šå…·ä½“æ¡ˆä¾‹ï¼Œä¸°å¯Œå›ç­”å†…å®¹</li>
                    </ul>
                </div>
            `;
        }
        
        // è¾…åŠ©åŠŸèƒ½
        function copyVersion(index) {
            // å®ç°å¤åˆ¶åŠŸèƒ½
            logSystem(`ğŸ“‹ å·²å¤åˆ¶ç‰ˆæœ¬ ${index + 1} å†…å®¹`);
            alert('âœ… å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        }
        
        function downloadVersion(index) {
            // å®ç°ä¸‹è½½åŠŸèƒ½
            logSystem(`ğŸ’¾ å·²ä¸‹è½½ç‰ˆæœ¬ ${index + 1}`);
            alert('âœ… æ–‡ä»¶ä¸‹è½½å·²å¼€å§‹');
        }
        
        function clearFile() {
            currentFile = null;
            currentParsedData = null;
            document.getElementById('fileInput').value = '';
            document.getElementById('fileInfo').classList.add('hidden');
            document.getElementById('uploadResult').classList.add('hidden');
            document.getElementById('uploadContent').innerHTML = `
                <p style="font-size: 1.5rem; margin-bottom: 15px;">ğŸ“</p>
                <p style="font-weight: 600; margin-bottom: 10px;">æ‹–æ‹½ç®€å†æ–‡ä»¶åˆ°æ­¤å¤„</p>
                <p style="font-size: 0.9rem; color: #718096;">æ”¯æŒ PDFã€Word (doc/docx) æ ¼å¼ï¼Œæœ€å¤§ 5MB</p>
            `;
            logSystem('ğŸ—‘ï¸ å·²æ¸…é™¤æ–‡ä»¶');
        }
        
        function clearOptimization() {
            document.getElementById('jobDescription').value = '';
            document.getElementById('optimizeResult').classList.add('hidden');
            logSystem('ğŸ”„ å·²é‡ç½®ä¼˜åŒ–');
        }
        
        function clearDelivery() {
            document.getElementById('keywords').value = '';
            document.getElementById('location').value = '';
            document.getElementById('salaryRange').value = '';
            document.getElementById('deliverResult').classList.add('hidden');
            logSystem('ğŸ”„ å·²é‡ç½®æŠ•é€’');
        }
        
        function clearInterview() {
            document.getElementById('interviewQuestion').value = '';
            document.getElementById('interviewAnswer').value = '';
            document.getElementById('interviewResult').classList.add('hidden');
            logSystem('ğŸ”„ å·²é‡ç½®é¢è¯•');
        }
        
        // ç³»ç»ŸåŠŸèƒ½
        async function checkAPIStatus() {
            try {
                const response = await fetch(`${API_BASE_URL}/health`);
                const data = await response.json();
                
                systemStats.apiStatus = data.status === 'healthy' ? 'online' : 'offline';
                document.getElementById('apiStatus').textContent = systemStats.apiStatus === 'online' ? 'ğŸŸ¢' : 'ğŸ”´';
                
                if (systemStats.apiStatus === 'online') {
                    logSystem('âœ… APIæœåŠ¡æ­£å¸¸');
                } else {
                    logSystem('âŒ APIæœåŠ¡å¼‚å¸¸');
                }
            } catch (error) {
                systemStats.apiStatus = 'offline';
                document.getElementById('apiStatus').textContent = 'ğŸ”´';
                logSystem('âŒ æ— æ³•è¿æ¥APIæœåŠ¡');
            }
        }
        
        function updateStats() {
            document.getElementById('parseQuality').textContent = systemStats.parseQuality + '%';
            document.getElementById('optimizeCount').textContent = systemStats.optimizations;
            document.getElementById('deliverCount').textContent = systemStats.deliveries;
        }
        
        function logSystem(message) {
            const logDiv = document.getElementById('systemLog');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML = `[${timestamp}] ${message}<br>` + logDiv.innerHTML;
            
            // é™åˆ¶æ—¥å¿—æ¡æ•°
            const lines = logDiv.innerHTML.split('<br>');
            if (lines.length > 10) {
                logDiv.innerHTML = lines.slice(0, 10).join('<br>');
            }
        }
    </script>
</body>
</html>