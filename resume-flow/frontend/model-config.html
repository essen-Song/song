<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ¨¡å‹é…ç½®ç®¡ç† - ResumeFlow Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .header h1 {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .header h1::before {
            content: "âš™ï¸";
            font-size: 1.2em;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
            line-height: 1.6;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .system-status {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .status-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .status-card h3 {
            font-size: 1.2em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-healthy { background: #2ecc71; }
        .status-warning { background: #f39c12; }
        .status-error { background: #e74c3c; }
        .status-disabled { background: #95a5a6; }
        
        .clusters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .cluster-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .cluster-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .cluster-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .cluster-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .cluster-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }
        
        .status-badge-healthy { background: #d5f4e6; color: #27ae60; }
        .status-badge-warning { background: #fdebd0; color: #f39c12; }
        .status-badge-error { background: #fadbd8; color: #e74c3c; }
        .status-badge-disabled { background: #ecf0f1; color: #7f8c8d; }
        
        .models-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .model-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }
        
        .model-info {
            flex: 1;
        }
        
        .model-name {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .model-type {
            font-size: 0.9em;
            color: #7f8c8d;
        }
        
        .model-status {
            font-size: 0.8em;
            padding: 3px 8px;
            border-radius: 10px;
        }
        
        .status-enabled { background: #d5f4e6; color: #27ae60; }
        .status-disabled { background: #ecf0f1; color: #7f8c8d; }
        
        .config-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .config-section h2 {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .btn-secondary {
            background: #95a5a6;
            color: white;
        }
        
        .actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .alert-success {
            background: #d5f4e6;
            color: #27ae60;
            border: 1px solid #a3e4c7;
        }
        
        .alert-error {
            background: #fadbd8;
            color: #e74c3c;
            border: 1px solid #f5b7b1;
        }
        
        .alert-warning {
            background: #fdebd0;
            color: #f39c12;
            border: 1px solid #f8c471;
        }
        
        .tab-container {
            margin-bottom: 30px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 25px;
            background: #ecf0f1;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: #3498db;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .model-details {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .api-key-input {
            position: relative;
        }
        
        .api-key-input input {
            padding-right: 100px;
        }
        
        .toggle-visibility {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #7f8c8d;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .clusters-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <div>
                    <h1>ğŸ¤– AIæ¨¡å‹é…ç½®ç®¡ç†</h1>
                    <p>ä¸“ä¸šçš„ä¼ä¸šçº§AIæ¨¡å‹é›†ç¾¤é…ç½®ç•Œé¢ - æ”¯æŒè®­ç»ƒå¸ˆå¯¹æ¨¡å‹è¿›è¡Œé…ç½®å’Œè®­ç»ƒ</p>
                </div>
                <div>
                    <a href="enterprise-app.html" class="btn btn-primary" style="text-decoration: none;">
                        ğŸ  è¿”å›é¦–é¡µ
                    </a>
                </div>
            </div>
        </div>

        <!-- ç³»ç»ŸçŠ¶æ€ä»ªè¡¨æ¿ -->
        <div class="dashboard">
            <div class="system-status">
                <h2>ğŸ“Š ç³»ç»Ÿæ¦‚è§ˆ</h2>
                <div id="systemOverview">
                    <div class="loading"></div> åŠ è½½ç³»ç»ŸçŠ¶æ€...
                </div>
            </div>
            
            <div class="system-status">
                <h2>âš¡ å¿«é€Ÿæ“ä½œ</h2>
                <div class="actions">
                    <button class="btn btn-primary" onclick="refreshStatus()">
                        ğŸ”„ åˆ·æ–°çŠ¶æ€
                    </button>
                    <button class="btn btn-secondary" onclick="exportConfig()">
                        ğŸ“¤ å¯¼å‡ºé…ç½®
                    </button>
                    <button class="btn btn-danger" onclick="resetConfig()">
                        ğŸ”„ é‡ç½®é…ç½®
                    </button>
                </div>
            </div>
        </div>

        <!-- é›†ç¾¤çŠ¶æ€ -->
        <div class="config-section">
            <h2>ğŸ—ï¸ AIæ¨¡å‹é›†ç¾¤</h2>
            <div class="clusters-grid" id="clustersContainer">
                <div class="loading"></div> åŠ è½½é›†ç¾¤ä¿¡æ¯...
            </div>
        </div>

        <!-- é…ç½®ç®¡ç† -->
        <div class="tab-container">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('config')">ğŸ”§ æ¨¡å‹é…ç½®</button>
                <button class="tab" onclick="switchTab('training')">ğŸ¯ è®­ç»ƒç®¡ç†</button>
                <button class="tab" onclick="switchTab('monitoring')">ğŸ“ˆ æ€§èƒ½ç›‘æ§</button>
            </div>
            
            <!-- æ¨¡å‹é…ç½®æ ‡ç­¾é¡µ -->
            <div class="tab-content active" id="config-tab">
                <div class="config-section">
                    <h2>â• æ·»åŠ æ–°æ¨¡å‹</h2>
                    <form id="addModelForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="clusterSelect">é€‰æ‹©é›†ç¾¤ *</label>
                                <select id="clusterSelect" required>
                                    <option value="">è¯·é€‰æ‹©é›†ç¾¤...</option>
                                    <option value="resumeParser">ç®€å†è§£æé›†ç¾¤</option>
                                    <option value="resumeOptimizer">ç®€å†ä¼˜åŒ–é›†ç¾¤</option>
                                    <option value="interviewCoach">é¢è¯•æ•™ç»ƒé›†ç¾¤</option>
                                    <option value="jobMatcher">èŒä½åŒ¹é…é›†ç¾¤</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="modelName">æ¨¡å‹åç§° *</label>
                                <input type="text" id="modelName" placeholder="ä¾‹å¦‚: GPT-4 Resume Expert" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="modelType">æ¨¡å‹ç±»å‹ *</label>
                                <select id="modelType" required>
                                    <option value="">è¯·é€‰æ‹©ç±»å‹...</option>
                                    <option value="openai">OpenAI GPTç³»åˆ—</option>
                                    <option value="claude">Anthropic Claudeç³»åˆ—</option>
                                    <option value="ernie">ç™¾åº¦æ–‡å¿ƒä¸€è¨€</option>
                                    <option value="local">æœ¬åœ°æ¨¡å‹</option>
                                    <option value="custom">è‡ªå®šä¹‰æ¨¡å‹</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="modelEndpoint">APIç«¯ç‚¹ *</label>
                                <input type="url" id="modelEndpoint" placeholder="https://api.openai.com/v1/chat/completions" required>
                            </div>
                            
                            <div class="form-group api-key-input">
                                <label for="apiKey">APIå¯†é’¥ *</label>
                                <input type="password" id="apiKey" placeholder="è¾“å…¥APIå¯†é’¥" required>
                                <button type="button" class="toggle-visibility" onclick="toggleApiKeyVisibility()">ğŸ‘ï¸</button>
                            </div>
                            
                            <div class="form-group">
                                <label for="modelWeight">æƒé‡ (1.0-2.0)</label>
                                <input type="number" id="modelWeight" min="0.1" max="3.0" step="0.1" value="1.0">
                            </div>
                        </div>
                        
                        <div class="actions">
                            <button type="submit" class="btn btn-success">
                                ğŸ’¾ ä¿å­˜é…ç½®
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearForm()">
                                ğŸ—‘ï¸ æ¸…ç©ºè¡¨å•
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- è®­ç»ƒç®¡ç†æ ‡ç­¾é¡µ -->
            <div class="tab-content" id="training-tab">
                <div class="config-section">
                    <h2>ğŸ¯ æ¨¡å‹è®­ç»ƒç®¡ç†</h2>
                    <div id="trainingStatus">
                        <p>è®­ç»ƒç®¡ç†åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                        <div class="alert alert-warning">
                            <strong>æ³¨æ„ï¼š</strong> æ¨¡å‹è®­ç»ƒåŠŸèƒ½éœ€è¦ä¸“é—¨çš„è®­ç»ƒæ•°æ®å’Œè®¡ç®—èµ„æºã€‚è¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜è·å–è®­ç»ƒæƒé™ã€‚
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- æ€§èƒ½ç›‘æ§æ ‡ç­¾é¡µ -->
            <div class="tab-content" id="monitoring-tab">
                <div class="config-section">
                    <h2>ğŸ“ˆ æ€§èƒ½ç›‘æ§</h2>
                    <div id="performanceMetrics">
                        <p>æ€§èƒ½ç›‘æ§åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                        <div class="alert alert-info">
                            <strong>æç¤ºï¼š</strong> ç›‘æ§åŠŸèƒ½å°†æ˜¾ç¤ºæ¨¡å‹å“åº”æ—¶é—´ã€æˆåŠŸç‡ã€é”™è¯¯ç‡ç­‰å…³é”®æŒ‡æ ‡ã€‚
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ¶ˆæ¯æç¤ºåŒºåŸŸ -->
        <div id="messageArea"></div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentConfig = null;
        let apiKeyVisible = false;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadSystemStatus();
            loadClusters();
            setupEventListeners();
        });

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // è¡¨å•æäº¤
            document.getElementById('addModelForm').addEventListener('submit', handleAddModel);
            
            // é›†ç¾¤é€‰æ‹©å˜åŒ–
            document.getElementById('clusterSelect').addEventListener('change', updateModelTemplates);
            
            // æ¨¡å‹ç±»å‹å˜åŒ–
            document.getElementById('modelType').addEventListener('change', updateEndpointTemplate);
        }

        // åŠ è½½ç³»ç»ŸçŠ¶æ€
        async function loadSystemStatus() {
            try {
                const response = await fetch('http://localhost:3002/api/config/status');
                const data = await response.json();
                
                if (data.success) {
                    currentConfig = data.system;
                    renderSystemOverview(data.system);
                } else {
                    showMessage('ç³»ç»ŸçŠ¶æ€åŠ è½½å¤±è´¥: ' + data.error, 'error');
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯: ' + error.message, 'error');
            }
        }

        // åŠ è½½é›†ç¾¤ä¿¡æ¯
        async function loadClusters() {
            try {
                const response = await fetch('http://localhost:3002/api/config/clusters');
                const data = await response.json();
                
                if (data.success) {
                    renderClusters(data.clusters);
                } else {
                    showMessage('é›†ç¾¤ä¿¡æ¯åŠ è½½å¤±è´¥: ' + data.error, 'error');
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯: ' + error.message, 'error');
            }
        }

        // æ¸²æŸ“ç³»ç»Ÿæ¦‚è§ˆ
        function renderSystemOverview(system) {
            const container = document.getElementById('systemOverview');
            const healthRate = system.healthRate || 0;
            
            let statusClass = 'status-error';
            let statusText = 'å¼‚å¸¸';
            
            if (healthRate >= 80) {
                statusClass = 'status-healthy';
                statusText = 'å¥åº·';
            } else if (healthRate >= 50) {
                statusClass = 'status-warning';
                statusText = 'è­¦å‘Š';
            }
            
            container.innerHTML = `
                <div class="status-card">
                    <h3>ç³»ç»Ÿå¥åº·çŠ¶æ€</h3>
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <span class="status-indicator ${statusClass}"></span>
                        <span style="font-size: 1.5em; font-weight: 600;">${statusText}</span>
                        <span style="font-size: 2em;">${healthRate}%</span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>é›†ç¾¤æ€»æ•°: <strong>${system.totalClusters}</strong></div>
                        <div>å¥åº·é›†ç¾¤: <strong>${system.healthyClusters}</strong></div>
                        <div>å…è´¹æ¨¡å‹: <strong>${system.freeModels?.models || 0}</strong></div>
                        <div>æœ€åæ›´æ–°: <strong>${new Date(system.lastUpdated).toLocaleString()}</strong></div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                        <div style="font-weight: 600; margin-bottom: 5px;">ç‰ˆæœ¬</div>
                        <div>${system.version}</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                        <div style="font-weight: 600; margin-bottom: 5px;">å…è´¹æ¨¡å‹</div>
                        <div>${system.freeModels?.enabled ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}</div>
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“é›†ç¾¤ä¿¡æ¯
        function renderClusters(clusters) {
            const container = document.getElementById('clustersContainer');
            let html = '';
            
            Object.keys(clusters).forEach(clusterKey => {
                const cluster = clusters[clusterKey];
                const statusInfo = currentConfig?.clusters?.[clusterKey] || {};
                
                let statusClass = 'status-badge-disabled';
                let statusText = 'æœªé…ç½®';
                
                if (statusInfo.status === 'healthy') {
                    statusClass = 'status-badge-healthy';
                    statusText = 'å¥åº·';
                } else if (statusInfo.status === 'warning') {
                    statusClass = 'status-badge-warning';
                    statusText = 'è­¦å‘Š';
                } else if (statusInfo.status === 'error') {
                    statusClass = 'status-badge-error';
                    statusText = 'å¼‚å¸¸';
                }
                
                html += `
                    <div class="cluster-card">
                        <div class="cluster-header">
                            <div class="cluster-title">${cluster.name}</div>
                            <div class="cluster-status ${statusClass}">${statusText}</div>
                        </div>
                        
                        <div style="margin-bottom: 15px; color: #7f8c8d;">
                            ${cluster.description}
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                            <span>æ¨¡å‹: ${statusInfo.enabledModels || 0}/${statusInfo.totalModels || 0}</span>
                            <span>é…ç½®ç‡: ${statusInfo.configurationRate || 0}%</span>
                        </div>
                        
                        <div class="models-list">
                            ${cluster.models.map(model => `
                                <div class="model-item">
                                    <div class="model-info">
                                        <div class="model-name">${model.name}</div>
                                        <div class="model-type">${model.type} â€¢ ${model.model}</div>
                                    </div>
                                    <div class="model-status ${model.enabled ? 'status-enabled' : 'status-disabled'}">
                                        ${model.enabled ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <button class="btn btn-primary" onclick="configureCluster('${clusterKey}')" style="width: 100%;">
                                âš™ï¸ é…ç½®é›†ç¾¤
                            </button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾
            event.target.classList.add('active');
        }

        // åˆ‡æ¢APIå¯†é’¥å¯è§æ€§
        function toggleApiKeyVisibility() {
            const apiKeyInput = document.getElementById('apiKey');
            const toggleButton = document.querySelector('.toggle-visibility');
            
            apiKeyVisible = !apiKeyVisible;
            apiKeyInput.type = apiKeyVisible ? 'text' : 'password';
            toggleButton.textContent = apiKeyVisible ? 'ğŸ™ˆ' : 'ğŸ‘ï¸';
        }

        // æ›´æ–°æ¨¡å‹æ¨¡æ¿
        function updateModelTemplates() {
            const cluster = document.getElementById('clusterSelect').value;
            const modelType = document.getElementById('modelType').value;
            
            if (cluster && modelType) {
                // æ ¹æ®é›†ç¾¤å’Œç±»å‹è®¾ç½®æ¨èçš„æ¨¡å‹åç§°
                const modelName = document.getElementById('modelName');
                const endpoint = document.getElementById('modelEndpoint');
                
                const templates = {
                    'resumeParser': {
                        'openai': { name: 'GPT-4 Resume Expert', endpoint: 'https://api.openai.com/v1/chat/completions' },
                        'claude': { name: 'Claude Resume Analyzer', endpoint: 'https://api.anthropic.com/v1/messages' },
                        'ernie': { name: 'æ–‡å¿ƒä¸€è¨€ç®€å†è§£æ', endpoint: 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions' }
                    },
                    'resumeOptimizer': {
                        'openai': { name: 'GPT-4 Optimizer Pro', endpoint: 'https://api.openai.com/v1/chat/completions' },
                        'claude': { name: 'Claude Writing Expert', endpoint: 'https://api.anthropic.com/v1/messages' },
                        'ernie': { name: 'æ–‡å¿ƒä¸€è¨€ä¼˜åŒ–ä¸“å®¶', endpoint: 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions' }
                    }
                };
                
                const template = templates[cluster]?.[modelType];
                if (template) {
                    modelName.value = template.name;
                    endpoint.value = template.endpoint;
                }
            }
        }

        // æ›´æ–°ç«¯ç‚¹æ¨¡æ¿
        function updateEndpointTemplate() {
            const modelType = document.getElementById('modelType').value;
            const endpoint = document.getElementById('modelEndpoint');
            
            const endpoints = {
                'openai': 'https://api.openai.com/v1/chat/completions',
                'claude': 'https://api.anthropic.com/v1/messages',
                'ernie': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
                'local': 'http://localhost:11434/v1/chat/completions'
            };
            
            if (endpoints[modelType]) {
                endpoint.value = endpoints[modelType];
            }
        }

        // å¤„ç†æ·»åŠ æ¨¡å‹
        async function handleAddModel(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const cluster = document.getElementById('clusterSelect').value;
            
            const modelConfig = {
                name: document.getElementById('modelName').value,
                type: document.getElementById('modelType').value,
                endpoint: document.getElementById('modelEndpoint').value,
                apiKey: document.getElementById('apiKey').value,
                model: 'custom-model', // å¯ä»¥æ ¹æ®ç±»å‹è®¾ç½®é»˜è®¤å€¼
                weight: parseFloat(document.getElementById('modelWeight').value) || 1.0,
                maxTokens: 2000,
                timeout: 30000,
                specialty: 'è‡ªå®šä¹‰é…ç½®'
            };
            
            try {
                const response = await fetch(`http://localhost:3002/api/config/models/${cluster}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(modelConfig)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showMessage('âœ… æ¨¡å‹æ·»åŠ æˆåŠŸï¼', 'success');
                    clearForm();
                    // åˆ·æ–°çŠ¶æ€
                    loadSystemStatus();
                    loadClusters();
                } else {
                    showMessage('âŒ æ¨¡å‹æ·»åŠ å¤±è´¥: ' + data.error, 'error');
                }
            } catch (error) {
                showMessage('âŒ ç½‘ç»œé”™è¯¯: ' + error.message, 'error');
            }
        }

        // æ¸…ç©ºè¡¨å•
        function clearForm() {
            document.getElementById('addModelForm').reset();
            apiKeyVisible = false;
            document.getElementById('apiKey').type = 'password';
            document.querySelector('.toggle-visibility').textContent = 'ğŸ‘ï¸';
        }

        // é…ç½®é›†ç¾¤
        function configureCluster(clusterKey) {
            showMessage(`æ­£åœ¨é…ç½® ${clusterKey} é›†ç¾¤...`, 'info');
            // è¿™é‡Œå¯ä»¥è·³è½¬åˆ°é›†ç¾¤è¯¦ç»†é…ç½®é¡µé¢
        }

        // åˆ·æ–°çŠ¶æ€
        function refreshStatus() {
            showMessage('ğŸ”„ æ­£åœ¨åˆ·æ–°ç³»ç»ŸçŠ¶æ€...', 'info');
            loadSystemStatus();
            loadClusters();
            setTimeout(() => {
                showMessage('âœ… çŠ¶æ€åˆ·æ–°å®Œæˆï¼', 'success');
            }, 1000);
        }

        // å¯¼å‡ºé…ç½®
        async function exportConfig() {
            try {
                const response = await fetch('http://localhost:3002/api/config/export');
                const data = await response.json();
                
                if (data.success) {
                    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `model-config-${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                    showMessage('âœ… é…ç½®å¯¼å‡ºæˆåŠŸï¼', 'success');
                } else {
                    showMessage('âŒ é…ç½®å¯¼å‡ºå¤±è´¥: ' + data.error, 'error');
                }
            } catch (error) {
                showMessage('âŒ ç½‘ç»œé”™è¯¯: ' + error.message, 'error');
            }
        }

        // é‡ç½®é…ç½®
        async function resetConfig() {
            if (!confirm('âš ï¸ ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                return;
            }
            
            try {
                const response = await fetch('http://localhost:3002/api/config/reset', {
                    method: 'POST'
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showMessage('âœ… é…ç½®é‡ç½®æˆåŠŸï¼', 'success');
                    // åˆ·æ–°çŠ¶æ€
                    loadSystemStatus();
                    loadClusters();
                } else {
                    showMessage('âŒ é…ç½®é‡ç½®å¤±è´¥: ' + data.error, 'error');
                }
            } catch (error) {
                showMessage('âŒ ç½‘ç»œé”™è¯¯: ' + error.message, 'error');
            }
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message, type) {
            const messageArea = document.getElementById('messageArea');
            const alertClass = `alert alert-${type}`;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = alertClass;
            messageDiv.innerHTML = message;
            
            messageArea.appendChild(messageDiv);
            
            // 3ç§’åè‡ªåŠ¨æ¶ˆå¤±
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }
    </script>
</body>
</html>