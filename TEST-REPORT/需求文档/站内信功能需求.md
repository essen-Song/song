# 站内信功能需求文档

> 文档编号：REQ-008
> 版本：v1.0
> 作者：测试总监 吉姆
> 日期：2026-02-23
> 状态：待开发

---

## 一、功能概述

### 1.1 背景
当前平台站内信入口存在但功能不可用（openChat函数缺失），需要完整实现站内信功能。

### 1.2 目标
- 实现站内信基础功能
- 支持消息已读/未读状态
- 支持多人消息通知

---

## 二、功能需求

### 2.1 消息列表

**入口位置：** 侧边栏"站内信"菜单 + 顶部导航栏消息图标

**列表展示：**

| 字段 | 说明 |
|------|------|
| 发送人 | 消息发送者姓名 |
| 消息标题 | 消息主题 |
| 发送时间 | 消息发送时间 |
| 状态 | 已读/未读（未读加粗+红点） |

**交互：**
- 点击消息进入详情页
- 未读消息点击后自动标记已读

### 2.2 消息详情

**展示内容：**

| 字段 | 说明 |
|------|------|
| 发送人 | 消息发送者 |
| 接收人 | 消息接收者（支持多人） |
| 发送时间 | 消息发送时间 |
| 消息内容 | 消息正文 |
| 已读状态 | 显示已读/未读人员列表 |

**已读状态展示：**
```
已读状态：3/5 人已读
✓ 马东西  2026-02-23 11:00
✓ 吕子乔  2026-02-23 11:30
✓ 凯文    2026-02-23 12:00
○ 马丁    未读
○ 露西    未读
```

### 2.3 发送消息

**入口：** 消息列表页"发送消息"按钮

**表单字段：**

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| 接收人 | 多选 | 是 | 选择接收人员 |
| 消息标题 | 文本 | 是 | 消息主题 |
| 消息内容 | 文本域 | 是 | 消息正文 |

**接收人选项：**
- 全员
- 马东西（前端架构师）
- 吕子乔（后端架构师）
- 凯文（产品经理）
- 马丁（AI训练师）
- 吉姆（测试总监）
- 露西（HR）
- 文学（主理人）

### 2.4 未读提示

**位置：** 顶部导航栏消息图标

**展示：**
- 有未读消息：显示红点或数字
- 无未读消息：仅显示图标

---

## 三、技术需求

### 3.1 前端（马东西）

| 任务 | 说明 |
|------|------|
| 修复openChat函数 | 点击站内信菜单可正常打开 |
| 消息列表页面 | 展示消息列表，支持已读/未读状态 |
| 消息详情页面 | 展示消息详情和已读状态 |
| 发送消息页面 | 表单和发送功能 |
| 未读提示 | 顶部导航栏红点/数字提示 |

### 3.2 后端（吕子乔）

| 任务 | 说明 |
|------|------|
| 消息存储API | 保存消息到内存/文件 |
| 消息列表API | 获取消息列表 |
| 消息详情API | 获取消息详情 |
| 发送消息API | 发送消息给指定人员 |
| 已读状态API | 标记消息已读、获取已读状态 |

### 3.3 数据结构

**消息对象：**
```javascript
{
  id: "msg_001",
  sender: "吉姆",
  senderRole: "测试总监",
  receivers: ["马东西", "吕子乔", "凯文"],
  title: "风险分析报告待评审",
  content: "请查看智能投递功能风险分析报告...",
  sendTime: "2026-02-23 10:30:00",
  readStatus: [
    { name: "马东西", readTime: "2026-02-23 11:00:00" },
    { name: "吕子乔", readTime: null },
    { name: "凯文", readTime: null }
  ]
}
```

---

## 四、验收标准

### 4.1 功能验收

- [ ] 点击站内信菜单可正常打开消息列表
- [ ] 消息列表正确展示所有消息
- [ ] 未读消息有视觉区分（加粗+红点）
- [ ] 点击消息可查看详情
- [ ] 查看详情后自动标记已读
- [ ] 可发送消息给指定人员
- [ ] 已读状态正确显示已读/未读人员
- [ ] 顶部导航栏显示未读提示

### 4.2 体验验收

- [ ] 消息列表加载有loading状态
- [ ] 发送消息有成功/失败提示
- [ ] 无消息时显示空状态引导

---

## 五、开发排期

| 任务 | 责任人 | 预计工时 |
|------|--------|----------|
| 后端API开发 | 吕子乔 | 1天 |
| 前端页面开发 | 马东西 | 1天 |
| 联调测试 | 吉姆 | 0.5天 |

---

## 六、相关文档

- BUG-001：openChat函数缺失
- REQ-006：站内信已读状态需求

---

*本文档待开发人员确认后进入开发阶段。*
